# Neural Style Transfer на PyTorch

Нейронный перенос стиля — это техника, позволяющая создавать художественные изображения, перенося стиль одного изображения на содержимое другого, используя сверточные нейронные сети.

## Описание

Этот проект реализует алгоритм нейронного переноса стиля с использованием архитектуры VGG19. Алгоритм работает следующим образом:
- Извлекает признаки с определенных слоев предобученной модели VGG19
- Вычисляет потерю контента на основе признаков более глубоких слоев
- Рассчитывает матрицу Грама для вычисления потери стиля
- Оптимизирует изображение для сохранения контента целевого изображения и стиля референсного изображения

## Зависимости

Для запуска проекта необходимы следующие библиотеки:
- PyTorch
- torchvision
- PIL
- matplotlib
- numpy

Установите их с помощью команды:
```bash
pip install torch torchvision pillow matplotlib numpy
```

## Как использовать

### 1. Загрузите изображения
```python
from PIL import Image

content_img = Image.open('path/to/content/image.jpg').convert('RGB')
style_img = Image.open('path/to/style/image.jpg').convert('RGB')
```

### 2. Подготовьте изображения
```python
transform = transforms.Compose([
    transforms.Resize((256, 256)),
    transforms.ToTensor()
])

content_tensor = transform(content_img).unsqueeze(0).to(device)
style_tensor = transform(style_img).unsqueeze(0).to(device)
```

### 3. Создайте модель и задайте параметры оптимизации
```python
model = Style_Net().to(device)
generated_img = content_tensor.clone().requires_grad_(True)
optimizer = torch.optim.LBFGS([generated_img.requires_grad_()], lr=1)
weights = {
    'content': 1,
    'style': [10.0, 0.8, 5.0, 3.0, 0.1]  # веса для разных слоев
}
```

### 4. Запустите процесс обучения
```python
for epoch in range(epochs):
    optimizer.step(closure)
    # визуализация промежуточных результатов
```

### 5. Сохраните результат
```python
result_img = transform_back(generated_img)
result_img.save('result.jpg')
```

## Параметры настройки

- **Размер изображения**: По умолчанию 256×256, можно изменить в преобразованиях
- **Количество итераций**: Количество шагов оптимизации
- **Веса потерь**: Баланс между контентом и стилем можно настроить:
  - `content_weight` - вес потери контента
  - `style_weights` - веса для разных слоев при вычислении потери стиля
- **Выбор слоев**: Индексы слоев для вычисления потерь задаются в конструкторе Style_Net


## Особенности реализации

- Используется предобученная модель VGG19
- Матрица Грама применяется для вычисления потерь стиля
- Алгоритм LBFGS используется для эффективной оптимизации
- Поддержка GPU для ускорения вычислений
- Визуализация промежуточных результатов в процессе обучения


